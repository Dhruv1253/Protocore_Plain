<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Protocore — Founders Split</title>
  <link rel="stylesheet" href="./styles.css">
</head>
<body>
  <div class="bg-gradient"></div>
  <div class="container">
    <header class="header">
      <div class="logo">
        <!-- Protocore badge -->
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" width="36" height="36" aria-hidden="true">
          <defs><linearGradient id="g" x1="0" y1="0" x2="1" y2="1"><stop offset="0" stop-color="#7C3AED"/><stop offset="1" stop-color="#06B6D4"/></linearGradient></defs>
          <rect width="200" height="200" rx="32" fill="url(#g)"/>
          <g fill="white" font-family="Arial, Helvetica, sans-serif" font-weight="700">
            <text x="50%" y="55%" font-size="84" text-anchor="middle" dominant-baseline="middle">P</text>
          </g>
        </svg>
        <h2>Protocore • Founders Split</h2>
      </div>
      <div class="row">
        <span id="whoami" class="badge"></span>
        <button id="logoutBtn" class="btn hidden">Logout</button>
      </div>
    </header>

    <!-- LOGIN -->
    <section id="loginSection" class="card center">
      <form id="loginForm" class="grid gap" autocomplete="on">
        <div class="center">
          <h3>Login</h3>
          <p>Founders only (3 users, equal split)</p>
        </div>
        <label>
          <div>Email</div>
          <input id="email" type="email" class="input" placeholder="founder@protocore.in" required>
        </label>
        <label>
          <div>Password</div>
          <input id="password" type="password" class="input" placeholder="••••••••" required>
        </label>
        <div class="row">
          <button class="btn" type="submit">Login</button>
          <span id="loginMsg" class="badge"></span>
        </div>
      </form>
    </section>

    <!-- DASHBOARD -->
    <section id="dashboardSection" class="hidden">
      <div class="grid2">
        <section class="card pad">
          <h3>Add / Edit Transaction</h3>
          <form id="txnForm" class="grid gap">
            <input type="hidden" id="editId" value="">
            <div class="grid2">
              <label>
                <div>Amount (₹)</div>
                <input id="amount" class="input" inputmode="decimal" placeholder="0.00">
              </label>
              <label>
                <div>Paid By</div>
                <select id="paidBy" class="select"></select>
              </label>
            </div>
            <div class="grid2">
              <label>
                <div>Description</div>
                <input id="desc" class="input" placeholder="Snacks, Uber, SaaS…">
              </label>
              <label>
                <div>Date</div>
                <input id="date" type="date" class="input">
              </label>
            </div>
            <div class="row">
              <button class="btn" id="saveBtn" type="submit">Add Transaction</button>
              <button class="btn btn-ghost hidden" id="cancelEditBtn" type="button">Cancel Edit</button>
              <span id="txnMsg" class="badge"></span>
            </div>
          </form>
        </section>

        <section class="card pad">
          <h3>Summary</h3>
          <p>Total Spend: <strong id="total">₹ 0.00</strong></p>
          <p>Per Founder (equal 1/3): <strong id="perHead">₹ 0.00</strong></p>
          <table>
            <thead><tr><th>Founder</th><th>Paid</th><th>Net (Paid - Share)</th></tr></thead>
            <tbody id="summaryBody"></tbody>
          </table>
        </section>
      </div>

      <section class="card pad">
        <h3>Who owes whom?</h3>
        <ul id="transfersList"></ul>
      </section>

      <section class="card pad">
        <h3>Reports</h3>
        <div class="grid2">
          <div class="row">
            <label>From&nbsp;<input id="fromDate" type="month" class="input" style="max-width:200px"></label>
            <label>To&nbsp;<input id="toDate" type="month" class="input" style="max-width:200px"></label>
            <button id="exportCsvBtn" class="btn" type="button">Export CSV</button>
            <button id="showChartBtn" class="btn" type="button">Show Chart</button>
          </div>
          <div class="row"><span id="reportMsg" class="badge"></span></div>
        </div>
        <canvas id="reportChart" height="120"></canvas>
      </section>

      <section class="card pad">
        <h3>All Transactions</h3>
        <table>
          <thead><tr><th>Date</th><th>Description</th><th>Paid By</th><th>Amount (₹)</th><th>Edited</th><th>Action</th></tr></thead>
        <tbody id="txnsBody"></tbody>
        </table>
      </section>
    </section>
  </div>

  <!-- Firebase config -->
  <script>
    window.firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_AUTH_DOMAIN",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_STORAGE_BUCKET",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID",
      measurementId: ""
    };
    window.editorEmail = "dhruv1253@gmail.com"; // only this email can edit
  </script>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

  <!-- App logic -->
  <script type="module" src="./app.js"></script>
</body>
</html>
